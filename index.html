<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Type Master Pro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>

<body class="text-white bg-black">
<div id="app"></div>

<script>
/* ================= FIREBASE ================= */
firebase.initializeApp({
  apiKey: "AIzaSyAv__llreM9IMHGkSSd7sfLESK-C5f8dwk",
  authDomain: "ltn-project-typing.firebaseapp.com",
  projectId: "ltn-project-typing"
});
const db = firebase.firestore();

/* ================= SENTENCES (BIG PACK) ================= */
const SENTENCES = [
  "The quick brown fox jumps over the lazy dog.",
  "Typing fast requires accuracy before speed.",
  "Practice every day to improve your typing skill.",
  "Consistency is more important than talent.",
  "Small progress every day leads to big success.",
  "Accuracy matters more than raw speed.",
  "Focus on rhythm while typing sentences.",
  "Typing without looking builds muscle memory.",
  "Mistakes help you learn faster.",
  "Speed comes naturally after accuracy.",
  "The keyboard becomes easier with practice.",
  "Typing tests are fun ways to track progress.",
  "Do not rush focus on correct letters.",
  "Every mistake is a chance to improve.",
  "Your fingers learn faster than you think.",
  "Typing is a useful skill for school work.",
  "Fast typing saves time during homework.",
  "Coding becomes easier with fast typing.",
  "Stay calm while typing long sentences.",
  "Confidence improves typing speed.",
  "Long sentences require patience and focus.",
  "Typing is a mix of speed rhythm and accuracy.",
  "Practicing ten minutes daily is enough.",
  "Do not compare yourself to others.",
  "Progress matters more than rankings.",
  "Focus on clean inputs and correct spelling.",
  "Muscle memory builds over time naturally.",
  "Typing tests help improve concentration.",
  "Your speed increases as errors decrease.",
  "Enjoy the process of learning to type."
];

/* ================= STATE ================= */
let mode = "menu";

/* Typing */
let currentSentence = "";
let userInput = "";
let startTime = null;
let isActive = false;
let isFinished = false;
let wpm = 0;
let accuracy = 100;
let errors = 0;

/* Click */
let clicks = 0;
let clickStart = null;
let clickRunning = false;
let clickTime = 5;

/* Leaderboard */
let leaderboardData = [];
let playerName = localStorage.getItem("playerName") || "";

/* ================= HELPERS ================= */
function randomSentence() {
  currentSentence = SENTENCES[Math.floor(Math.random() * SENTENCES.length)];
}

function resetTyping() {
  userInput = "";
  startTime = null;
  isActive = false;
  isFinished = false;
  wpm = 0;
  accuracy = 100;
  errors = 0;
  randomSentence();
}

/* ================= TYPING ================= */
function handleTyping(e) {
  if (!isActive && e.target.value.length > 0) {
    startTime = Date.now();
    isActive = true;
  }
  userInput = e.target.value;
  if (userInput === currentSentence) finishTyping();
  render();
}

function finishTyping() {
  isFinished = true;
  isActive = false;

  const timeMin = (Date.now() - startTime) / 60000;
  const words = currentSentence.split(" ").length;
  wpm = Math.round(words / timeMin);

  errors = 0;
  for (let i = 0; i < userInput.length; i++) {
    if (userInput[i] !== currentSentence[i]) errors++;
  }

  accuracy = Math.round(((currentSentence.length - errors) / currentSentence.length) * 100);

  if (!playerName) {
    playerName = prompt("Enter your name");
    localStorage.setItem("playerName", playerName);
  }

  db.collection("leaderboard").add({
    name: playerName,
    wpm,
    accuracy,
    time: Date.now()
  });
}

/* ================= CLICK ================= */
function startClickTest() {
  clicks = 0;
  clickRunning = true;
  clickStart = Date.now();

  setTimeout(() => {
    clickRunning = false;
    render();
  }, clickTime * 1000);
}

function registerClick() {
  if (clickRunning) clicks++;
  render();
}

/* ================= LEADERBOARD ================= */
function loadLeaderboard() {
  db.collection("leaderboard")
    .orderBy("wpm", "desc")
    .limit(10)
    .get()
    .then(snapshot => {
      leaderboardData = snapshot.docs.map(d => d.data());
      render();
    });
}

/* ================= RENDER ================= */
function render() {
  const app = document.getElementById("app");

  /* ===== MENU ===== */
  if (mode === "menu") {
    app.innerHTML = `
      <div class="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-purple-900 via-gray-900 to-indigo-900 p-8">
        <h1 class="text-6xl font-bold mb-10">Type Master Pro</h1>

        <div class="grid md:grid-cols-3 gap-6 max-w-5xl w-full">
          <div onclick="mode='typing';resetTyping();render()"
            class="cursor-pointer bg-gray-800/50 p-8 rounded-3xl hover:scale-105 transition">
            <div class="text-6xl mb-4">âŒ¨ï¸</div>
            <h2 class="text-3xl font-bold">Typing Test</h2>
          </div>

          <div onclick="mode='click';render()"
            class="cursor-pointer bg-gray-800/50 p-8 rounded-3xl hover:scale-105 transition">
            <div class="text-6xl mb-4">ğŸ–±ï¸</div>
            <h2 class="text-3xl font-bold">Click Test</h2>
          </div>

          <div onclick="mode='leaderboard';loadLeaderboard()"
            class="cursor-pointer bg-gray-800/50 p-8 rounded-3xl hover:scale-105 transition">
            <div class="text-6xl mb-4">ğŸ†</div>
            <h2 class="text-3xl font-bold">Leaderboard</h2>
          </div>
        </div>

        <footer class="mt-12 text-gray-400 text-sm">
          Â© 2025 Ltn Project
        </footer>
      </div>`;
    return;
  }

  /* ===== TYPING ===== */
  if (mode === "typing") {
    app.innerHTML = `
      <div class="min-h-screen bg-gradient-to-br from-purple-900 via-gray-900 to-indigo-900 p-8 flex justify-center">
        <div class="max-w-3xl w-full">
          <div class="bg-gray-800 p-6 rounded-xl text-2xl mb-4">
            ${currentSentence.split("").map((c,i)=>{
              let color="text-gray-500";
              if(i<userInput.length) color=userInput[i]===c?"text-green-400":"text-red-500";
              return `<span class="${color}">${c}</span>`;
            }).join("")}
          </div>

          ${!isFinished ? `
            <textarea oninput="handleTyping(event)"
              class="w-full p-4 rounded-xl bg-gray-800 border-2 border-purple-500 text-xl"
              placeholder="Start typing...">${userInput}</textarea>
          ` : `
            <div class="bg-gray-800 p-6 rounded-xl text-center">
              <div class="text-3xl">WPM: ${wpm}</div>
              <div>Accuracy: ${accuracy}%</div>
              <div>Errors: ${errors}</div>
              <button onclick="resetTyping();render()"
                class="mt-4 w-full py-3 bg-purple-600 rounded-xl font-bold">
                ğŸ”„ Try Again
              </button>
            </div>
          `}

          ${isActive ? `
            <div class="flex justify-between mt-4">
              <div>â±ï¸ ${Math.floor((Date.now()-startTime)/1000)}s</div>
              <div>ğŸ“Š ${Math.round((userInput.length/currentSentence.length)*100)}%</div>
            </div>
          ` : ""}

          <button onclick="mode='menu';render()"
            class="mt-6 px-6 py-3 bg-gray-700 rounded-xl">
            ğŸ”™ Back
          </button>
        </div>
      </div>`;
    return;
  }

  /* ===== CLICK ===== */
  if (mode === "click") {
    app.innerHTML = `
      <div class="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-purple-900 via-gray-900 to-indigo-900 p-8">
        <h1 class="text-5xl font-bold mb-6">Click Speed Test</h1>
        <div class="text-3xl mb-4">Clicks: ${clicks}</div>

        ${!clickRunning ? `
          <button onclick="startClickTest()"
            class="px-10 py-6 bg-pink-600 rounded-2xl text-2xl font-bold">
            â–¶ Start (${clickTime}s)
          </button>
        ` : `
          <button onclick="registerClick()"
            class="px-16 py-10 bg-pink-500 rounded-full text-3xl font-bold animate-pulse">
            CLICK
          </button>
        `}

        <button onclick="mode='menu';render()"
          class="mt-8 px-6 py-3 bg-gray-700 rounded-xl">
          ğŸ”™ Back
        </button>
      </div>`;
    return;
  }

  /* ===== LEADERBOARD ===== */
  if (mode === "leaderboard") {
    app.innerHTML = `
      <div class="min-h-screen bg-gradient-to-br from-purple-900 via-gray-900 to-indigo-900 p-8 flex justify-center">
        <div class="max-w-2xl w-full bg-gray-800 p-6 rounded-xl">
          <h1 class="text-4xl font-bold mb-6 text-center">ğŸ† Leaderboard</h1>

          ${leaderboardData.map((d,i)=>`
            <div class="flex justify-between border-b border-gray-700 py-2">
              <div>#${i+1} ${d.name}</div>
              <div>${d.wpm} WPM (${d.accuracy}%)</div>
            </div>
          `).join("")}

          <button onclick="mode='menu';render()"
            class="mt-6 w-full py-3 bg-purple-600 rounded-xl font-bold">
            ğŸ”™ Back
          </button>
        </div>
      </div>`;
  }
}

/* ================= INIT ================= */
randomSentence();
render();
</script>
</body>
</html>